on:
    push:

jobs:

    fixer-without-cache:
        name: PHP-CS-Fixer cache test
        runs-on: ubuntu-latest

        steps:
            -   uses: actions/checkout@v2
                with:
                    repository: redaxo/redaxo # just check out any code

            -   name: Setup PHP
                uses: shivammathur/setup-php@v2
                with:
                    php-version: 7.1

            -   name: Install Dependencies
                run: composer require friendsofphp/php-cs-fixer

            -   name: run
                run: time vendor/bin/php-cs-fixer fix --diff --dry-run --cache-file /tmp/.php_cs.cache

            -   name: repeated run
                run: time vendor/bin/php-cs-fixer fix --diff --dry-run --cache-file /tmp/.php_cs.cache


    fixer-with-cache:
        name: PHP-CS-Fixer cache test
        runs-on: ubuntu-latest

        steps:
            -   uses: actions/checkout@v2
                with:
                    repository: redaxo/redaxo # just check out any code

            -   name: Setup PHP
                uses: shivammathur/setup-php@v2
                with:
                    php-version: 7.1

            -   name: Install Dependencies
                run: composer require friendsofphp/php-cs-fixer

            -   name: Cache Primes
                id: cache-primes
                uses: actions/cache@v1
                with:
                    path: .php_cs.cache
                    key: ${{ runner.os }}-primes

            -   name: run
                run: time vendor/bin/php-cs-fixer fix --diff --dry-run --cache-file /tmp/.php_cs.cache

            -   name: repeated run
                run: time vendor/bin/php-cs-fixer fix --diff --dry-run --cache-file /tmp/.php_cs.cache

